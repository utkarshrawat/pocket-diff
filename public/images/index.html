<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Tools | Pocket Diff</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/global.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav></nav>

    <div class="container">
        <div id="imgTools" class="active">
            <div class="tool-header">
                <h2>Offline Image Studio</h2>
                <p class="subtext">Resize, Crop, Filter & Compress. 100% Client-Side.</p>
            </div>

            <div class="editor-layout">
                
                <div class="editor-sidebar">
                    
                    <div class="control-group">
                        <input type="file" id="fileInput" accept="image/*" hidden>
                        <div class="row-group">
                            <button class="action-btn" style="flex-grow: 1;" onclick="document.getElementById('fileInput').click()">üìÇ Upload</button>
                            <button class="action-btn outline" style="width: 40px; padding: 8px;" onclick="clearImage()" title="Clear Image">üóëÔ∏è</button>
                        </div>
                        <div id="fileInfo" class="info-text">No file selected</div>
                    </div>

                    <hr class="divider">

                    <div class="control-group">
                        <label>Crop Tool</label>
                        <button id="btnStartCrop" class="action-btn outline small" onclick="toggleCropMode()">‚úÇÔ∏è Enable Crop</button>
                        <div id="cropControls" class="row-group hidden" style="margin-top:5px;">
                            <button class="action-btn small success" onclick="applyCrop()">Apply</button>
                            <button class="action-btn small" style="background:#ef4444;" onclick="cancelCrop()">Cancel</button>
                        </div>
                        <div id="cropInfo" class="info-text"></div>
                    </div>

                    <hr class="divider">

                    <div class="control-group">
                        <label>Resize <span id="aspectRatioDisplay" style="font-weight:normal; color:#3b82f6; margin-left:5px;"></span></label>
                        <div class="row-group">
                            <input type="number" id="imgWidth" placeholder="W" oninput="handleResize('w')">
                            <span style="color:#555">x</span>
                            <input type="number" id="imgHeight" placeholder="H" oninput="handleResize('h')">
                        </div>
                        <label class="checkbox-label"><input type="checkbox" id="lockRatio" checked> Lock Ratio</label>
                    </div>

                    <hr class="divider">

                    <div class="control-group">
                        <label>Filters</label>
                        <div class="filter-grid">
                            <button class="filter-btn" onclick="applyFilter('grayscale')">B&W</button>
                            <button class="filter-btn" onclick="applyFilter('sepia')">Sepia</button>
                            <button class="filter-btn" onclick="applyFilter('invert')">Invert</button>
                            <button class="filter-btn" onclick="applyFilter('vintage')">Vintage</button>
                        </div>
                        <button class="action-btn outline small" style="margin-top:10px; width:100%;" onclick="resetImage()">‚Ü∫ Reset to Original</button>
                    </div>

                    <hr class="divider">

                    <div class="control-group">
                        <label>Export</label>
                        <select id="exportFormat" onchange="calculateSize()">
                            <option value="image/png">PNG</option>
                            <option value="image/jpeg">JPEG</option>
                            <option value="image/webp">WebP</option>
                        </select>
                        <div class="row-group" style="margin-top:5px; justify-content:space-between;">
                            <label style="margin:0;">Quality</label>
                            <input type="range" id="imgQuality" min="0.1" max="1" step="0.1" value="0.9" oninput="updateQualityLabel()" style="width:60%">
                            <span id="qualityVal" class="info-text">90%</span>
                        </div>
                        <div id="estSize" class="info-text" style="color:#10b981; font-weight:bold; text-align:right;">Est: -</div>
                    </div>

                    <button class="action-btn large success" style="width:100%" onclick="downloadImage()">Download</button>

                </div>

                <div class="editor-canvas-area" id="dropZone">
                    <canvas id="editorCanvas"></canvas>
                    
                    <div id="cropOverlay">
                        <div class="crop-handle nw" data-handle="nw"></div>
                        <div class="crop-handle ne" data-handle="ne"></div>
                        <div class="crop-handle sw" data-handle="sw"></div>
                        <div class="crop-handle se" data-handle="se"></div>
                    </div>

                    <div id="placeholderText">
                        <div style="font-size:40px; margin-bottom:10px;">üñºÔ∏è</div>
                        Drag & Drop Image Here
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script src="../js/nav.js"></script>
    <script src="../js/storage.js"></script>
    <script src="script.js"></script>
</body>
</html>